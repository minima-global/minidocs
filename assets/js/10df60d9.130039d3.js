"use strict";(self.webpackChunkminima_docs=self.webpackChunkminima_docs||[]).push([[6481],{7331:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>l,frontMatter:()=>o,metadata:()=>t,toc:()=>c});var i=r(5893),a=r(1151);const o={sidebar_position:5},s="Run an archive node",t={id:"runanode/archivenodes",title:"Run an archive node",description:"Archive nodes serve an important function of being able to recover any Minima user if they lose access to their node or require a re-sync to the chain.",source:"@site/docs/runanode/archivenodes.md",sourceDirName:"runanode",slug:"/runanode/archivenodes",permalink:"/docs/runanode/archivenodes",draft:!1,unlisted:!1,editUrl:"https://github.com/minima-global/minidocs/docs/runanode/archivenodes.md",tags:[],version:"current",sidebarPosition:5,frontMatter:{sidebar_position:5},sidebar:"tutorialSidebar",previous:{title:"Desktop Command Line",permalink:"/docs/runanode/selectplatform/manualnode"},next:{title:"User Guides",permalink:"/docs/userguides/"}},d={},c=[{value:"Use cases",id:"use-cases",level:2},{value:"System requirements",id:"system-requirements",level:2},{value:"Minimum hardware requirements",id:"minimum-hardware-requirements",level:3},{value:"Ports",id:"ports",level:3},{value:"Starting an archive node",id:"starting-an-archive-node",level:2},{value:"Manual archive node (desktop)",id:"manual-archive-node-desktop",level:3},{value:"Examples",id:"examples",level:4},{value:"Windows",id:"windows",level:4},{value:"Mac",id:"mac",level:4},{value:"Linux",id:"linux",level:4},{value:"Docker archive node",id:"docker-archive-node",level:3},{value:"Examples: Starting a new archive node",id:"examples-starting-a-new-archive-node",level:4},{value:"Linux VPS",id:"linux-vps",level:4},{value:"Windows",id:"windows-1",level:4},{value:"Mac",id:"mac-1",level:4},{value:"Linux desktop",id:"linux-desktop",level:4},{value:"Check your archive data",id:"check-your-archive-data",level:2}];function h(e){const n={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.a)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h1,{id:"run-an-archive-node",children:"Run an archive node"}),"\n",(0,i.jsx)(n.p,{children:"Archive nodes serve an important function of being able to recover any Minima user if they lose access to their node or require a re-sync to the chain."}),"\n",(0,i.jsx)(n.p,{children:"A standard Minima node is constantly pruning the chain and only holds the latest 2 months of archive blocks for the purpose of sharing missing recent blocks with other nodes that are rejoining the network after some time offline."}),"\n",(0,i.jsx)(n.p,{children:"An archive node does not prune blocks after 2 months and can therefore be used to re-sync another node from the genesis block."}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsxs)(n.p,{children:["An archive node can only be used to re-sync users who created their nodes after your archive node was created. If you wish to be able to recover ",(0,i.jsx)(n.em,{children:"any"})," Minima user, you must perform a chain re-sync from an archive node that holds the entire blockchain since genesis."]})}),"\n",(0,i.jsx)(n.h2,{id:"use-cases",children:"Use cases"}),"\n",(0,i.jsx)(n.p,{children:"Archive nodes can be for personal use or public use."}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Personal Archive Node"})}),"\n",(0,i.jsx)(n.p,{children:"A user running a node on a mobile device may choose to run an Archive node locally on their laptop/desktop at home in case they lose their phone and do not have a valid backup of their node stored elsewhere. In this case, the user would always have the latest proofs for their coins on their own Archive node and they can recover their phone wallet to a new device without relying on any other Minima user."}),"\n"]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Public Archive Node"})}),"\n",(0,i.jsxs)(n.p,{children:["A user can choose to run an archive node for the purpose of helping other Minima users recover their wallet. By exporting their archive data to a file, another user can import the archive file and recover their wallet.\r\nIf the archive node is on a server with a static external IP address, other users can also use the ip",":port"," of the archive node to recover their wallet by remotely connecting to the archive node."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["To learn more about archive nodes, please see the ",(0,i.jsx)(n.a,{href:"/docs/learn/minima/aboutarchivenodes",children:"archive nodes"})," page."]}),"\n",(0,i.jsx)(n.h2,{id:"system-requirements",children:"System requirements"}),"\n",(0,i.jsx)(n.p,{children:"Anyone can run an archive node from Android, desktop or server."}),"\n",(0,i.jsx)(n.h3,{id:"minimum-hardware-requirements",children:"Minimum hardware requirements"}),"\n",(0,i.jsx)(n.p,{children:"The following assumes that only Minima is running on the server, you should consider increasing the RAM and storage depending on the requirements for other software you install e.g. virus protection etc"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Processing:"})," 2 CPU ",(0,i.jsx)("br",{}),"\r\n",(0,i.jsx)(n.strong,{children:"Memory:"})," 4GB RAM",(0,i.jsx)("br",{}),"\r\n",(0,i.jsx)(n.strong,{children:"Storage:"})," 5GB*"]}),"\n",(0,i.jsx)(n.p,{children:"*This may change over time."}),"\n",(0,i.jsx)(n.h3,{id:"ports",children:"Ports"}),"\n",(0,i.jsx)(n.p,{children:"If running an archive node on a desktop, no port forwarding is required."}),"\n",(0,i.jsx)(n.p,{children:"If running a public archive node on a server, open inbound connections on port 9001 (or the main custom Minima port you have chosen)."}),"\n",(0,i.jsx)(n.h2,{id:"starting-an-archive-node",children:"Starting an archive node"}),"\n",(0,i.jsx)(n.p,{children:"When you start an archive node, you will start storing the archive data from that point onwards, therefore you can only re-sync coins for users that are created after this point."}),"\n",(0,i.jsx)(n.p,{children:"It is possible to run an archive node that stores all blocks since the Genesis block by doing a chain re-sync from another archive node that already has all blocks."}),"\n",(0,i.jsx)(n.h3,{id:"manual-archive-node-desktop",children:"Manual archive node (desktop)"}),"\n",(0,i.jsxs)(n.p,{children:["To start a Minima archive node manually, add the ",(0,i.jsx)(n.code,{children:"-archive"})," parameter to the start up command."]}),"\n",(0,i.jsxs)(n.p,{children:["If you have an existing node that you wish to change to an archive node, first take a backup of your existing node, then ",(0,i.jsx)(n.code,{children:"quit"})," your node from the Terminal and restart the same node, adding in the ",(0,i.jsx)(n.code,{children:"-archive"})," parameter on the start up line."]}),"\n",(0,i.jsx)(n.admonition,{type:"important",children:(0,i.jsxs)(n.p,{children:["If you used the ",(0,i.jsx)(n.code,{children:"-data"})," parameter to specify a data folder when starting your existing node, you must make sure you start the archive node using the same data folder you chose originally."]})}),"\n",(0,i.jsx)(n.h4,{id:"examples",children:"Examples"}),"\n",(0,i.jsx)(n.h4,{id:"windows",children:"Windows"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"java -jar C:\\Users\\INSERTUSERNAME\\Downloads\\minima.jar -mdsenable -archive\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mac",children:"Mac"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo java -jar /Users/INSERTUSERNAME/Downloads/minima.jar -mdsenable -archive\n"})}),"\n",(0,i.jsx)(n.h4,{id:"linux",children:"Linux"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"sudo java -jar /home/INSERTUSERNAME/minima.jar -mdsenable -archive\n"})}),"\n",(0,i.jsx)(n.h3,{id:"docker-archive-node",children:"Docker archive node"}),"\n",(0,i.jsxs)(n.p,{children:["To start a Minima archive node container, you need to add the ",(0,i.jsx)(n.code,{children:"-e minima_archive=true"})," environment variable to the start up command."]}),"\n",(0,i.jsxs)(n.p,{children:["If you originally started your node without the ",(0,i.jsx)(n.code,{children:"-e minima_archive=true"})," environment variable, you can either:"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"start a new separate container for your archive node,"}),"\n",(0,i.jsx)(n.li,{children:"backup your existing node, the restore it to a new archive container you create,"}),"\n",(0,i.jsxs)(n.li,{children:["backup your existing node, then stop and remove your existing Minima container and start a new Minima container including ",(0,i.jsx)(n.code,{children:"-e minima_archive=true"}),", using the ",(0,i.jsx)(n.strong,{children:"SAME"})," data folder as your old node e.g. minimadocker9001 or minimadocker8001"]}),"\n"]}),"\n",(0,i.jsx)(n.h4,{id:"examples-starting-a-new-archive-node",children:"Examples: Starting a new archive node"}),"\n",(0,i.jsx)(n.h4,{id:"linux-vps",children:"Linux VPS"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker run -d -e minima_mdspassword=INSERTPASSWORD -e minima_server=true -e minima_archive=true -v ~/minimadockerarchive:/home/minima/data -p 7001-7003:9001-9003 --restart unless-stopped --name minimaarchive minimaglobal/minima:latest\n"})}),"\n",(0,i.jsx)(n.h4,{id:"windows-1",children:"Windows"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker run -d -e minima_mdspassword=INSERTPASSWORD -e minima_desktop=true -e minima_archive=true -v C:\\Users\\INSERTUSERNAME\\minimadockerarchive:/home/minima/data -p 7001-7003:9001-9003 --restart unless-stopped --name minimaarchive minimaglobal/minima:latest\n"})}),"\n",(0,i.jsx)(n.h4,{id:"mac-1",children:"Mac"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker run -d -e minima_mdspassword=INSERTPASSWORD -e minima_desktop=true -e minima_archive=true -v ~/minimadockerarchive:/home/minima/data -p 7001-7003:9001-9003 --restart unless-stopped --name minimaarchive minimaglobal/minima:latest\n"})}),"\n",(0,i.jsx)(n.h4,{id:"linux-desktop",children:"Linux desktop"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"docker run -d -e minima_mdspassword=INSERTPASSWORD -e minima_desktop=true -e minima_archive=true -v ~/minimadockerarchive:/home/minima/data -p 7001-7003:9001-9003 --restart unless-stopped --name minimaarchive minimaglobal/minima:latest\n"})}),"\n",(0,i.jsx)(n.h2,{id:"check-your-archive-data",children:"Check your archive data"}),"\n",(0,i.jsx)(n.p,{children:"From the Terminal MiniDapp or Docker CLI, you can check the integrity of your archive data by running the command:"}),"\n",(0,i.jsx)(n.p,{children:"This checks your archive data for missing or broken blocks and tells you the first block you can sync users from. If there is an error, you will need to re-sync from another archive node."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"archive action:integrity\n"})}),"\n",(0,i.jsxs)(r,{children:[(0,i.jsx)("summary",{children:" Example output "}),(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:'archive action:integrity\r\n{\r\n  "command":"archive",\r\n  "params":{\r\n    "action":"integrity"\r\n  },\r\n  "status":true,\r\n  "pending":false,\r\n  "response":{\r\n    "message":"Archive integrity check completed",\r\n    "start":1,\r\n    "blocks":6443,\r\n    "cascade":true,\r\n    "errors":0,\r\n    "recommend":"Your ArchiveDB is correct and has no errors."\r\n  }\r\n}\n'})})]})]})}function l(e={}){const{wrapper:n}={...(0,a.a)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},1151:(e,n,r)=>{r.d(n,{Z:()=>t,a:()=>s});var i=r(7294);const a={},o=i.createContext(a);function s(e){const n=i.useContext(o);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),i.createElement(o.Provider,{value:n},e.children)}}}]);